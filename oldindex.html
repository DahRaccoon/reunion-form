<!DOCTYPE html>

<html lang="en"><head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Table Rock Lake Family Reunion</title>
<style>
    body { font-family: Arial, sans-serif; background: #f4f4f4; margin: 0; padding: 0; }
    header { background: #2d6a4f; color: white; padding: 1em; text-align: center; }
    section { margin: 2em; background: white; border-radius: 8px; padding: 1.5em; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
    h2 { color: #2d6a4f; }
    .row { display: flex; flex-wrap: wrap; gap: 1em; margin-bottom: 0.8em; }
    label, .activity { display: block; width: 100%; margin-bottom: 0.8em; }
    input[type="text"], select, textarea { width: 100%; padding: 0.5em; border-radius: 4px; border: 1px solid #ccc; }
    input[type="number"] { width: 60px; padding: 0.3em; }
    input[type="submit"] { background-color: #2d6a4f; color: white; padding: 1em 2em; border: none; border-radius: 4px; cursor: pointer; font-size: 1em; margin-top: 1em; }
  </style>
<style>
#costSummaryBar {
  position: fixed;
  top: 100px;
  right: 20px;
  background: #2d6a4f;
  color: white;
  font-size: 1.1em;
  text-align: center;
  padding: 0.8em 1em;
  border-radius: 12px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.2);
  z-index: 9999;
}
</style></head>
<body><form action="https://script.google.com/macros/s/AKfycbxg1cRahAIp4dC_UYJ1oJfdv43xKvgq5rnyBvQCYkLNWBGMgczTe5UfFDZYAucwtuR9/exec" id="reunionForm" method="POST"><div style="position: relative; text-align: center; color: white; margin-bottom: 2em;"><img alt="Table Rock Lake Aerial View" src="Adventures_Table_Rock_Lake_Missouri_49.jpg" style="width: 100%; height: 300px; object-fit: cover; border-radius: 12px;"/></div><div id="costSummaryBar" style=" font-size: 0.95em; padding: 1em; text-align: left;"><div id="detailedSummary"></div></div>
<header>
<h1>Table Rock Lake Family Reunion</h1>
<p>Please complete this form to help us plan!</p>
</header><p style="color: #aa0000; font-weight: bold; text-align: center; margin: 1em auto;">‚ö†Ô∏è All prices are AI-generated estimates and may vary depending on actual bookings and vendor rates.</p>

<script>
const drivingDistances = {
  "Pocatello, ID": 1260,
  "Idaho Falls, ID": 1225,
  "Denver, CO": 790,
  "Peachtree City, GA": 660,
  "Salt Lake City, UT": 1170,
  "Springfield, MO": 0,
  "Tulsa, OK": 215
};

function updateTotal() {
  const lodging = parseFloat(document.getElementById("lodgingCost")?.value) || 0;
  const extra = document.getElementById("extraBed")?.checked ? 450 : 0;
  const adults = parseInt(document.getElementById("travelers")?.value) || 0;
  const children = parseInt(document.getElementById("childrenCount")?.value) || 0;
  const unitCount = adults + (children * 0.5);

  // Travel
  const mode = document.getElementById("travelMode")?.value;
  const origin = document.getElementById("travelOrigin")?.value;
  let travel = 0;
  if (mode === "flying") {
    travel = (adults * 400) + (children * 200);
  } else if (mode === "driving" && drivingDistances[origin] !== undefined) {
    travel = ((drivingDistances[origin] * 2) / 20) * 3.5;
  }

  // Excursions
  let excursions = 0;
  const details = [];
  const inputs = document.querySelectorAll('input[type="checkbox"][id$="Check"]');
  inputs.forEach(box => {
    if (box.checked) {
      const base = box.id.replace("Check", "");
      const adultInput = document.getElementById(base + "Adults");
      const childInput = document.getElementById(base + "Kids");
      const a = parseInt(adultInput?.value) || 0;
      const k = parseInt(childInput?.value) || 0;
      const label = box.parentElement?.innerText || "";
      const match = label.match(/\$(\d+) adult(?: \/ \$(\d+) child)?/);
      if (match) {
        const adultCost = parseInt(match[1]) || 0;
        const childCost = parseInt(match[2]) || 0;
        const cost = (a * adultCost) + (k * childCost);
        excursions += cost;
        if (cost > 0) {
          details.push(base.replace(/([A-Z])/g, ' $1').trim() + ": $" + cost.toFixed(2));
        }
      }
    }
  });

  // Food cost (per selected meal)
  let food = 0;
  const foodBoxes = document.querySelectorAll('input[type="checkbox"][id^="Sunday_"], input[type="checkbox"][id^="Monday_"], input[type="checkbox"][id^="Tuesday_"], input[type="checkbox"][id^="Wednesday_"], input[type="checkbox"][id^="Thursday_"], input[type="checkbox"][id^="Friday_"], input[type="checkbox"][id^="Saturday_"]');
  
  foodBoxes.forEach(box => {
    if (box.checked) {
      const id = box.id;
      let rate = 8;
      if (id.includes("Breakfast")) rate = 5;
      else if (id.includes("Lunch")) rate = 6;
      food += rate * unitCount;
    }
  });


  // Build receipt
  const breakdown = [];
  if (lodging > 0) breakdown.push("Lodging: $" + lodging.toFixed(2));
  if (extra > 0) breakdown.push("Additional Bed: $450.00");
  if (travel > 0) breakdown.push("Travel: $" + travel.toFixed(2));
  if (excursions > 0) {
    breakdown.push("Excursions:");
    breakdown.push(...details);
  }
  if (food > 0) breakdown.push("Food: $" + food.toFixed(2));

  const total = lodging + travel + excursions + extra + food;
  const receipt = "<strong>Total: $" + total.toFixed(2) + "</strong><br>" + breakdown.join("<br>");
  const summaryBox = document.getElementById("detailedSummary");
  if (summaryBox) summaryBox.innerHTML = receipt;
}
</script>
<section><h2>üè° Belle Rive Mansion</h2><img alt="Belle Rive Mansion" src="bellerivemansion-1536x1025.jpg" style="width: 100%; max-width: 500px; display: block; margin: 1em auto; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.2);"/><a href="https://lake123.com/the-belle-rive-mansion/" style="font-size: 1rem; color: #0a58ca; display: block; text-align: center; margin-bottom: 2em;" target="_blank">View full mansion details on lake123.com</a></section><div style="text-align:center;"><button id="submitButton" onclick="" type="submit">Submit Your Selections</button></div></form><script>
document.getElementById("submitButton").addEventListener("click", function(event) {
  event.preventDefault(); // prevent page refresh if needed
  const form = document.getElementById("reunionForm");
  let payload = {
    timestamp: new Date().toISOString(),
    adults: document.getElementById("travelers")?.value || "",
    kids: document.getElementById("childrenCount")?.value || "",
    lodging: document.getElementById("lodgingCost")?.value || "",
    travel: document.getElementById("travelMode")?.value || "",
    meals: [],
    excursions: [],
    total: document.querySelector("#detailedSummary strong")?.innerText.replace("Total: $", "") || "0"
  };

  document.querySelectorAll('input[type="checkbox"]').forEach(cb => {
    if (cb.checked && cb.id.match(/_(Breakfast|Lunch|Dinner)$/)) {
      payload.meals.push(cb.id);
    }
  });

  document.querySelectorAll('.activity').forEach(div => {
    const label = div.querySelector("label")?.innerText || "";
    const adults = div.querySelector("input[id*='Adults']")?.value || "0";
    const kids = div.querySelector("input[id*='Kids']")?.value || "0";
    if (adults !== "0" || kids !== "0") {
      payload.excursions.push({ label, adults, kids });
    }
  });

  let hiddenInput = document.getElementById("payloadField");
  if (!hiddenInput) {
    hiddenInput = document.createElement("input");
    hiddenInput.type = "hidden";
    hiddenInput.name = "json";
    hiddenInput.id = "payloadField";
    form.appendChild(hiddenInput);
  }
  hiddenInput.value = JSON.stringify(payload);

  form.submit(); // ‚úÖ this line is key!
});

});
</script></body></html>
