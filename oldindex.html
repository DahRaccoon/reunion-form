<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Family Reunion Form</title>
</head>
<body>
  <form id="reunionForm" action="https://eo5gybn2p24bjv0.m.pipedream.net" method="POST">
    <label>Family Name: <input type="text" name="familyName" required></label><br>
    <label>Attendees: <input type="text" name="attendees" required></label><br>
    <label>Lodging Cost: <input type="text" name="lodgingCost" id="lodgingCost" required></label><br>
    <label>Extra Bed: <input type="checkbox" name="extraBed"></label><br>
    <label>Travel Mode: <select name="travelMode">
      <option value="driving">Driving</option>
      <option value="flying">Flying</option>
    </select></label><br>
    <label>Travel Origin: <input type="text" name="travelOrigin"></label><br>
    <label>Arrival Airport: <select name="arrivalAirport">
      <option value="Springfield">Springfield</option>
      <option value="Bentonville">Bentonville</option>
    </select></label><br><br>

    <label>Adult Travelers: <input type="number" name="travelers" id="travelersInput"></label><br>
    <label>Child Travelers: <input type="number" name="childrenCount" id="childrenInput"></label><br><br>

    <!-- Meal selections -->
    <label><input type="checkbox" id="Sunday_Breakfast"> Sunday Breakfast</label><br>
    <label><input type="checkbox" id="Monday_Lunch"> Monday Lunch</label><br>
    <label><input type="checkbox" id="Tuesday_Dinner"> Tuesday Dinner</label><br><br>

    <!-- Excursion counts -->
    <label>Silver Dollar City Adults: <input type="number" id="SilverDollarCityAdults"></label><br>
    <label>Silver Dollar City Kids: <input type="number" id="SilverDollarCityKids"></label><br><br>

    <!-- Hidden fields for computed data -->
    <input type="hidden" name="selectedMeals" id="selectedMealsField" />
    <input type="hidden" name="excursionSummaries" id="excursionSummariesField" />
    <input type="hidden" name="detailedSummary" id="detailedSummaryField" />
    <input type="hidden" name="travelers" id="travelersField" />
    <input type="hidden" name="childrenCount" id="childrenCountField" />

    <button type="submit">Submit</button>
  </form>

  <script>
    function updateSummaryFields() {
      const foodBoxes = document.querySelectorAll('input[type="checkbox"]');
      const selectedMeals = Array.from(foodBoxes)
        .filter(cb => cb.checked)
        .map(cb => cb.id);
      document.getElementById("selectedMealsField").value = selectedMeals.join(", ");

      const adultTravelers = parseInt(document.getElementById("travelersInput").value || 0);
      const childTravelers = parseInt(document.getElementById("childrenInput").value || 0);
      document.getElementById("travelersField").value = adultTravelers;
      document.getElementById("childrenCountField").value = childTravelers;

      const excursionSummaries = [];
      const a = parseInt(document.getElementById("SilverDollarCityAdults").value || 0);
      const c = parseInt(document.getElementById("SilverDollarCityKids").value || 0);
      if (a + c > 0) {
        excursionSummaries.push(`Silver Dollar City: ${a} adult(s), ${c} kid(s)`);
      }
      document.getElementById("excursionSummariesField").value = excursionSummaries.join("; ");

      const lodging = parseFloat(document.getElementById("lodgingCost").value || 0);
      const mealCost = (adultTravelers + childTravelers * 0.5) * 8 * selectedMeals.length;
      const total = lodging + mealCost;
      document.getElementById("detailedSummaryField").value = total.toFixed(2);
    }

    // Update on change
    document.getElementById("reunionForm").addEventListener("change", updateSummaryFields);
    document.getElementById("reunionForm").addEventListener("submit", updateSummaryFields);
  </script>
</body>
</html>
