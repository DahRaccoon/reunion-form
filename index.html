<!DOCTYPE html>
<html lang="en">
<head>
    <style id="reunionTheme">
  /* ==== Theme tokens (easy to tweak later) ==== */
  #reunionForm {
    --primary: #0ea5e9;       /* blue */
    --primary-600: #0284c7;   /* hover */
    --text: #0f172a;          /* slate-900 */
    --muted: #475569;         /* slate-600 */
    --bg: #ffffff;
    --soft: #f8fafc;          /* light card/bg */
    --line: #e2e8f0;          /* borders */
    --ring: color-mix(in hsl, var(--primary) 22%, transparent);
  }

  /* ==== Page/frame polish ==== */
  body { background: #f7fafc; color: var(--text); }
  .container { max-width: 1060px; }

  /* ==== Form shell ==== */
  #reunionForm {
    background: var(--bg);
    border: 1px solid var(--line);
    border-radius: 1rem;
    box-shadow: 0 10px 30px rgba(2, 132, 199, 0.06);
    padding: 1.25rem;
  }

  /* Headings */
  #reunionForm h1, #reunionForm h2, #reunionForm h3 {
    line-height: 1.2;
    letter-spacing: -.01em;
  }
  #reunionForm h1 { font-weight: 800; }
  #reunionForm h2 {
    font-weight: 700;
    border-bottom: 1px solid var(--line);
    padding-bottom: .45rem;
    margin-bottom: .75rem;
  }
  #reunionForm h3 { color: var(--muted); font-weight: 700; }

  /* Optional banner treatment for section headers (uses your existing <h2>) */
  #reunionForm section > h2 {
    position: relative;
    background: linear-gradient(90deg, color-mix(in hsl, var(--primary) 12%, #fff), #fff);
    border: 1px solid var(--line);
    border-radius: .9rem;
    padding: .75rem 1rem;
    margin: 1rem 0 .75rem;
  }

  /* Labels */
  #reunionForm label { font-weight: 600; color: var(--text); }

  /* Inputs / selects / textareas */
  #reunionForm input[type="text"],
  #reunionForm input[type="number"],
  #reunionForm input[type="email"],
  #reunionForm select,
  #reunionForm textarea {
    width: 100%;
    border: 1px solid var(--line);
    border-radius: .8rem;
    padding: .7rem .9rem;
    font-size: .95rem;
    background: #fff;
    color: var(--text);
    transition: border-color .15s ease, box-shadow .15s ease, background .15s ease;
  }
  #reunionForm textarea { min-height: 110px; }
  #reunionForm input:focus,
  #reunionForm select:focus,
  #reunionForm textarea:focus {
    outline: none;
    border-color: var(--primary);
    box-shadow: 0 0 0 4px var(--ring);
  }

  /* Checkbox/radio polish */
  #reunionForm input[type="checkbox"],
  #reunionForm input[type="radio"] {
    width: 1.05rem; height: 1.05rem;
    accent-color: var(--primary);
  }

  /* Make your meals & interest lists auto-grid neatly without HTML changes */
  #meals-list,
  #excursions-container .space-y-2,
  #excursions-container .grid {
    row-gap: .75rem;
  }
  #meals-list > div,
  #excursions-container .space-y-2 > div {
    display: flex; align-items: center;
  }

  /* Excursion cards (your generated cards) */
  #excursions-container .bg-gray-50 {
    background: var(--soft) !important;
    border: 1px solid var(--line);
    border-radius: 1rem;
    transition: box-shadow .18s ease, transform .06s ease;
  }
  #excursions-container .bg-gray-50:hover {
    box-shadow: 0 16px 40px rgba(2,132,199,.08);
    transform: translateY(-1px);
  }
  #excursions-container .w-8.h-8 {
    background: #e5eef8 !important;
    color: #0b355a !important;
    transition: background .15s ease, transform .05s ease;
  }
  #excursions-container .w-8.h-8:hover { background: #d6e6f5 !important; }
  #excursions-container .w-8.h-8:active { transform: translateY(1px); }

  /* Summary bar (right sticky card) */
  .cost-summary-bar {
    background: #0f172a; /* deep slate */
    color: #fff;
    border: 1px solid rgba(255,255,255,.08);
    border-radius: 14px;
    box-shadow: 0 14px 40px rgba(15,23,42,.25);
  }
  .cost-summary-bar h3 { color: #fff; }
  .cost-summary-bar hr { border-color: rgba(255,255,255,.18); }
  .cost-summary-bar .text-gray-200 { color: rgba(255,255,255,.75) !important; }
  @media (max-width: 1024px) {
    .cost-summary-bar { box-shadow: none; }
  }

  /* Submit button (keeps your existing classes, just better feel) */
  #reunionForm [type="submit"] {
    background: var(--primary) !important;
    border-radius: .9rem !important;
    font-weight: 800 !important;
    letter-spacing: .01em;
    box-shadow: 0 14px 28px rgba(2,132,199,.22);
    transition: background .15s ease, transform .05s ease, box-shadow .15s ease !important;
  }
  #reunionForm [type="submit"]:hover {
    background: var(--primary-600) !important;
    box-shadow: 0 18px 44px rgba(2,132,199,.26);
  }
  #reunionForm [type="submit"]:active { transform: translateY(1px); }

  /* Confirmation overlay card glow */
  #confirmationCard {
    box-shadow: 0 30px 60px rgba(34, 197, 94, .25);
  }

  /* Gentle spacing tweaks */
  #reunionForm section { scroll-margin-top: 80px; }
  #reunionForm .space-y-8 > * + * { margin-top: 1.25rem; }
</style>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Family Reunion Form</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" />
    <style>
        /* Inter font for a clean, modern look */
        @import url('https://rsms.me/inter/inter.css');
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7fafc; /* Light gray background */
        }
        
        /* The main content container */
        .container {
            max-width: 1000px;
        }

        /* Floating summary bar */
        .cost-summary-bar {
            position: fixed;
            top: 100px;
            right: 20px;
            background: #4a5568; /* Darker gray background */
            color: #fff;
            padding: 1.5em;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            z-index: 9999;
            transition: all 0.3s ease-in-out;
            width: 300px;
            display: none; /* Initially hidden */
        }
        
        @media (max-width: 1024px) {
            .cost-summary-bar {
                position: static;
                width: 100%;
                margin-top: 2rem;
            }
        }
    </style>
</head>
<body class="text-gray-800">

    <div id="confirmationPage" class="fixed inset-0 bg-gray-50 flex items-center justify-center p-6 z-50 hidden">
        <div class="bg-white p-8 rounded-lg shadow-2xl max-w-xl text-center transition-transform duration-500 transform scale-95 opacity-0" id="confirmationCard">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-20 w-20 text-green-500 mx-auto mb-4" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
            </svg>
            <h1 class="text-3xl font-bold text-gray-900 mb-2">Form Submitted!</h1>
            <p class="text-gray-600 mb-4">Your family reunion form has been submitted successfully. Thank you!</p>
            <p class="text-sm font-semibold text-gray-500">Redirecting in <span id="countdown">5</span> seconds...</p>
        </div>
    </div>
    
    <div id="mainContent" class="py-12 px-6">
        <div class="container mx-auto flex flex-col lg:flex-row gap-8">
            
            <div class="flex-grow">
                <div class="mb-8 text-center">
                    <h1 class="text-4xl font-bold mb-2">Table Rock Lake Family Reunion</h1>
                    <p class="text-lg text-gray-600">Please complete this form to help us plan!</p>
                </div>
                
                <form id="reunionForm" class="bg-white p-6 rounded-lg shadow-lg space-y-8">
                    
                    <section>
                        <h2 class="text-2xl font-bold text-gray-900 mb-4 border-b pb-2">Family Information</h2>
                        <div class="space-y-4 pt-4">
                            <div>
                                <label for="familyName" class="block text-sm font-medium text-gray-700">Family Name</label>
                                <select id="familyName" name="familyName" required class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-3 py-2">
                                    <option value="">Select your family</option>
                                    <option value="Joe &amp; Kathy">Joe &amp; Kathy</option>
                                    <option value="Ryan">Ryan</option>
                                    <option value="Justin">Justin</option>
                                    <option value="Aubrey">Aubrey</option>
                                    <option value="Britney">Britney</option>
                                    <option value="Megan">Megan</option>
                                    <option value="Holly">Holly</option>
                                    <option value="Josh">Josh</option>
                                    <option value="Katie">Katie</option>
                                </select>
                            </div>
                            <div>
                                <label for="attendees" class="block text-sm font-medium text-gray-700">Who is attending? (Names & kids' ages)</label>
                                <textarea id="attendees" name="attendees" required rows="3" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-3 py-2"></textarea>
                            </div>
                        </div>
                    </section>

                    <section>
                        <h2 class="text-2xl font-bold text-gray-900 mb-4 border-b pb-2">Lodging Selection</h2>
                        <div class="space-y-4 pt-4">
                            <div>
                                <label for="lodgingCost" class="block text-sm font-medium text-gray-700">What type of lodging will your family need?</label>
                                <select id="lodgingCost" name="lodgingCost" required class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-3 py-2">
                                    <option value="">Select one</option>
                                    <option value="2129.63">Private bed only ‚Äî $2,129.63</option>
                                    <option value="2555.56">Bed + space for kids ‚Äî $2,555.56</option>
                                </select>
                            </div>
                            <div class="flex items-center">
                                <input type="checkbox" id="extraBed" name="extraBed" class="h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500">
                                <label for="extraBed" class="ml-2 block text-sm font-medium text-gray-700">Add an additional private bed ‚Äî $450</label>
                            </div>
                        </div>
                    </section>

                    <section>
                        <h2 class="text-2xl font-bold text-gray-900 mb-4 border-b pb-2">Travel Information</h2>
                        <div class="space-y-4 pt-4">
                            <div>
                                <label for="travelMode" class="block text-sm font-medium text-gray-700">How are you traveling?</label>
                                <select id="travelMode" name="travelMode" required class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-3 py-2">
                                    <option value="">Select</option>
                                    <option value="flying">Flying ($400/person)</option>
                                    <option value="driving">Driving (mileage-based)</option>
                                </select>
                            </div>
                            <div id="travel-origin-group">
                                <label for="travelOrigin" class="block text-sm font-medium text-gray-700">Travel Origin</label>
                                <select id="travelOrigin" name="travelOrigin" required class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-3 py-2">
                                    <option value="">Select</option>
                                    <option value="Pocatello, ID" data-distance="1350">Pocatello, ID (~1350 miles)</option>
                                    <option value="Idaho Falls, ID" data-distance="1363">Idaho Falls, ID (~1363 miles)</option>
                                    <option value="Denver, CO" data-distance="803">Denver, CO (~803 miles)</option>
                                    <option value="Peachtree City, GA" data-distance="640">Peachtree City, GA (~640 miles)</option>
                                    <option value="Salt Lake City, UT" data-distance="1286">Salt Lake City, UT (~1286 miles)</option>
                                    <option value="Springfield, MO" data-distance="44">Springfield, MO (~44 miles)</option>
                                </select>
                            </div>
                            <div id="mileage-details-group" class="hidden">
                                <p class="text-sm text-gray-600">Driving cost is calculated based on a round trip at 20 MPG and $3.00/gallon.</p>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label for="adultTravelers" class="block text-sm font-medium text-gray-700">Adult Travelers</label>
                                    <input type="number" id="adultTravelers" name="adultTravelers" min="1" value="1" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-3 py-2">
                                </div>
                                <div>
                                    <label for="childTravelers" class="block text-sm font-medium text-gray-700">Child Travelers</label>
                                    <input type="number" id="childTravelers" name="childTravelers" min="0" value="0" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-3 py-2">
                                </div>
                            </div>
                            <div>
                                <label for="arrivalAirport" class="block text-sm font-medium text-gray-700">Arrival Airport</label>
                                <select id="arrivalAirport" name="arrivalAirport" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-3 py-2">
                                    <option value="Springfield">Springfield</option>
                                    <option value="Bentonville">Bentonville</option>
                                    <option value="Tulsa">Tulsa</option>
                                </select>
                            </div>
                        </div>
                    </section>

                    <section>
                         <h2 class="text-2xl font-bold text-gray-900 mb-4 border-b pb-2">üçΩÔ∏è Meal Planning</h2>
                        <p class="text-gray-600 my-4">Select the meals your family will attend. The cost is calculated based on a base rate of $8 per meal for each adult, and $4 per meal for each child in your family.</p>
                        <div id="meals-list" class="space-y-4">
                            </div>
                    </section>

                    <section>
                        <h2 class="text-2xl font-bold text-gray-900 mb-4 border-b pb-2">Excursions</h2>
                        <p class="text-gray-600 my-4">Select number of participants for each activity.</p>
                        <div id="excursions-container" class="space-y-8">
                            </div>
                    </section>

                    <button type="submit" class="w-full bg-indigo-600 text-white font-semibold py-3 rounded-md transition-colors duration-200 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2">
                        Submit Form
                    </button>
                    <div id="messageBox" class="mt-4 p-3 bg-indigo-100 text-indigo-800 rounded-md hidden"></div>
                </form>
            </div>
            
            <div class="cost-summary-bar lg:flex-shrink-0">
                <h3 class="text-xl font-bold mb-4">Your Summary</h3>
                <div id="detailedSummary" class="space-y-3">
                    <div class="flex justify-between items-center">
                        <span class="text-gray-200">Lodging Cost:</span>
                        <span id="summary-lodging" class="font-semibold">$0.00</span>
                    </div>
                    <div class="flex justify-between items-center">
                        <span class="text-gray-200">Extra Bed:</span>
                        <span id="summary-extra-bed" class="font-semibold">$0.00</span>
                    </div>
                    <div class="flex justify-between items-center">
                        <span class="text-gray-200">Travel Cost:</span>
                        <span id="summary-travel" class="font-semibold">$0.00</span>
                    </div>
                    <div class="flex justify-between items-center">
                        <span class="text-gray-200">Meal Cost:</span>
                        <span id="summary-meals" class="font-semibold">$0.00</span>
                    </div>
                    <div class="flex justify-between items-center">
                        <span class="text-gray-200">Excursion Cost:</span>
                        <span id="summary-excursions" class="font-semibold">$0.00</span>
                    </div>
                    <hr class="border-t border-gray-600 my-4">
                    <div class="flex justify-between items-center text-xl font-bold">
                        <span>Total:</span>
                        <span id="summary-total">$0.00</span>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const reunionForm = document.getElementById('reunionForm');
            const mainContent = document.getElementById('mainContent');
            const confirmationPage = document.getElementById('confirmationPage');
            const confirmationCard = document.getElementById('confirmationCard');
            const messageBox = document.getElementById('messageBox');
            const costSummaryBar = document.querySelector('.cost-summary-bar');
            const mileageDetailsGroup = document.getElementById('mileage-details-group');
            const travelOriginSelect = document.getElementById('travelOrigin');
            
            // Google Form integration (your working URL + IDs)
            const googleFormUrl = "https://docs.google.com/forms/d/e/1FAIpQLScUApKt1GW2q3qqD9M6Y4EEvRlWFJ9eRbhUoGuIQXrO1RnmIA/formResponse";
            const googleFormEntryIds = {
              familyName:        "entry.410693715",
              attendees:         "entry.1402442371",
              lodging:           "entry.361829150",
              travelInfo:        "entry.246009107",
              travelers:         "entry.564596700",
              selectedMeals:     "entry.419259284",
              selectedExcursions:"entry.1987430049",
              interestItems:     "entry.601295490",
              totalCost:         "entry.202808949"
            };
            
            // --- DATA ---
            const excursions = [
                // Adventure & Thrill
                { id: "silverDollarCity", name: "Silver Dollar City", description: "1880s-style theme park with coasters, crafts, and live entertainment.", adultPrice: 89, childPrice: 79, category: "üé¢ Adventure & Thrill" },
                { id: "bransonMountainCoaster", name: "Branson Mountain Coaster", description: "Race through the Ozark hills on a self-controlled alpine coaster.", adultPrice: 20, childPrice: 20, category: "üé¢ Adventure & Thrill" },
                { id: "wolfeMountainZipline", name: "Wolfe Mountain Zipline", description: "Soar through tree canopies on scenic ziplines.", adultPrice: 130, childPrice: 130, category: "üé¢ Adventure & Thrill" },
                { id: "fritzsAdventure", name: "Fritz‚Äôs Adventure", description: "Indoor park with ropes courses, tunnels, and climbing walls.", adultPrice: 35, childPrice: 35, category: "üé¢ Adventure & Thrill" },
                { id: "shepherdHillsAdventurePark", name: "Shepherd of the Hills Adventure Park", description: "Ziplines, ropes courses, and a historic outdoor drama.", adultPrice: 30, childPrice: 30, category: "üé¢ Adventure & Thrill" },
                { id: "bigfootFunPark", name: "Bigfoot Fun Park", description: "Family fun with thrill rides, arcade games, and themed attractions.", adultPrice: 25, childPrice: 25, category: "üé¢ Adventure & Thrill" },
                { id: "xtremeRacingCenter", name: "Xtreme Racing Center", description: "High-speed go-karts on a professional outdoor track.", adultPrice: 40, childPrice: 40, category: "üé¢ Adventure & Thrill" },
                
                // Outdoors & Nature
                { id: "dogwoodCanyonNaturePark", name: "Dogwood Canyon Nature Park", description: "Explore trails, waterfalls, and wildlife in a 10,000-acre preserve.", adultPrice: 20, childPrice: 12, category: "üèûÔ∏è Outdoors & Nature" },
                { id: "topOfTheRockGolfCartTour", name: "Top of the Rock Golf Cart Tour", description: "Self-guided cart tour through canyons and caves.", adultPrice: 50, childPrice: 35, category: "üèûÔ∏è Outdoors & Nature" },
                { id: "tableRockLakeBoating", name: "Table Rock Lake & Boating", description: "Swimming, fishing, or boating on the crystal-clear lake.", adultPrice: 10, childPrice: 10, category: "üèûÔ∏è Outdoors & Nature" },
                { id: "ozarkMountainBiking", name: "Ozark Mountain Biking", description: "Tackle scenic mountain trails suited for all skill levels.", adultPrice: 20, childPrice: 20, category: "üèûÔ∏è Outdoors & Nature" },
                { id: "shepherdHillsPettingZoo", name: "Shepherd of the Hills Petting Zoo", description: "Feed goats, llamas, and other animals at this charming farm.", adultPrice: 10, childPrice: 10, category: "üèûÔ∏è Outdoors & Nature" },
                
                // Golf & Recreation
                { id: "bigCedarLodgeGolf", name: "Big Cedar Lodge Golf", description: "Play on world-class courses like Payne‚Äôs Valley.", adultPrice: 300, childPrice: 300, category: "‚õ≥ Golf & Recreation" },
                { id: "miniGolf", name: "Mini Golf", description: "Light-hearted competition at whimsical mini golf courses.", adultPrice: 15, childPrice: 15, category: "‚õ≥ Golf & Recreation" },
                { id: "bransonTracksArcade", name: "Branson Tracks & Arcade", description: "Go-kart tracks, classic arcade games, and mini thrill rides.", adultPrice: 15, childPrice: 15, category: "‚õ≥ Golf & Recreation" },
                { id: "familyBowlingNight", name: "Family Bowling Night", description: "Unwind at one of Branson‚Äôs retro or modern bowling alleys.", adultPrice: 25, childPrice: 25, category: "‚õ≥ Golf & Recreation" },
                
                // Shows & Entertainment
                { id: "dollyPartonStampede", name: "Dolly Parton‚Äôs Stampede", description: "Dinner and show with horseback stunts, music, and flair.", adultPrice: 65, childPrice: 35, category: "üé≠ Shows & Entertainment" },
                { id: "sightSoundTheatre", name: "Sight & Sound Theatre", description: "Epic Bible stories brought to life with Broadway-quality production.", adultPrice: 80, childPrice: 35, category: "üé≠ Shows & Entertainment" },
                { id: "showboatBransonBelle", name: "Showboat Branson Belle", description: "Cruise Table Rock Lake with dinner and a live variety show.", adultPrice: 70, childPrice: 40, category: "üé≠ Shows & Entertainment" },
                { id: "rezaEdgeOfIllusion", name: "Reza: Edge of Illusion", description: "Mind-blowing magic and illusion in a popular modern show.", adultPrice: 45, childPrice: 25, category: "üé≠ Shows & Entertainment" },
                { id: "clayCooperCountryExpress", name: "Clay Cooper‚Äôs Country Express", description: "High-energy country, rock, and comedy show.", adultPrice: 40, childPrice: 20, category: "üé≠ Shows & Entertainment" },
                { id: "presleysCountryJubilee", name: "The Presley‚Äôs Country Jubilee", description: "Classic Ozarks comedy and country music.", adultPrice: 42, childPrice: 20, category: "üé≠ Shows & Entertainment" },
                { id: "theHaygoods", name: "The Haygoods", description: "High-energy music show with pyrotechnics and modern harmonies.", adultPrice: 47, childPrice: 25, category: "üé≠ Shows & Entertainment" },

                // Indoor Fun & Museums
                { id: "wonderWorks", name: "WonderWorks", description: "Upside-down science museum with 100+ hands-on exhibits.", adultPrice: 35, childPrice: 20, category: "üß† Indoor Fun & Museums" },
                { id: "aquariumAtTheBoardwalk", name: "Aquarium at the Boardwalk", description: "Dive into ocean life with touch tanks and a jellyfish room.", adultPrice: 30, childPrice: 15, category: "üß† Indoor Fun & Museums" },
                { id: "titanicMuseum", name: "Titanic Museum", description: "Experience the Titanic through artifacts, replicas, and guided tours.", adultPrice: 35, childPrice: 20, category: "üß† Indoor Fun & Museums" },
                { id: "butterflyPalace", name: "Butterfly Palace", description: "Stroll through a tropical garden with thousands of free-flying butterflies.", adultPrice: 25, childPrice: 15, category: "üß† Indoor Fun & Museums" },
                { id: "ripleysBelieveItOrNot", name: "Ripley‚Äôs Believe It or Not!", description: "Explore weird, wacky, and unbelievable oddities.", adultPrice: 25, childPrice: 15, category: "üß† Indoor Fun & Museums" },
                { id: "hollywoodWaxMuseum", name: "Hollywood Wax Museum", description: "Pose with realistic wax figures of your favorite celebrities.", adultPrice: 30, childPrice: 18, category: "üß† Indoor Fun & Museums" },
                
                // Rentals
                { id: "jetSkiRentals", name: "Jet Ski Rentals", description: "Ride the waves on Table Rock Lake with fast and fun jet ski rentals.", adultPrice: 100, childPrice: 100, category: "üö§ Rentals (Shared Cost Estimate)" },
                { id: "boatAndTubes", name: "Boat and Tubes", description: "Rent a pontoon or ski boat for tubing, cruising, or relaxing.", adultPrice: 125, childPrice: 125, category: "üö§ Rentals (Shared Cost Estimate)" },
            ];

    const EXCURSION_LINKS = {
        silverDollarCity: "https://www.silverdollarcity.com/",
        bransonMountainCoaster: "https://www.bransonalpinemountaincoaster.com/",
        wolfeMountainZipline: "https://www.wolfemountainbranson.com/",
        fritzsAdventure: "https://www.fritzsadventure.com/",
        shepherdHillsAdventurePark: "https://theshepherdofthehills.com/adventure-park/",
        bigfootFunPark: "https://www.bigfootfunpark.com/",
        xtremeRacingCenter: "https://www.xtremeracingcenterbranson.com/",
        dogwoodCanyonNaturePark: "https://dogwoodcanyon.org/",
        topOfTheRockGolfCartTour: "https://bigcedar.com/activity/lost-canyon-cave-nature-trail/",
        tableRockLakeBoating: "https://www.stateparkmarina.com/",
        ozarkMountainBiking: "https://howlerbikepark.com/",
        shepherdHillsPettingZoo: "https://theshepherdofthehills.com/the-park/",
        bigCedarLodgeGolf: "https://bigcedar.com/golf/",
        miniGolf: "https://www.piratescove.net/locations/missouri/branson/",
        bransonTracksArcade: "https://www.bransontracks.com/",
        familyBowlingNight: "https://www.bowlandybs.com/branson",
        dollyPartonStampede: "https://dpstampede.com/branson",
        sightSoundTheatre: "https://www.sight-sound.com/branson",
        showboatBransonBelle: "https://www.silverdollarcity.com/showboat-branson/",
        rezaEdgeOfIllusion: "https://rezalive.com/",
        clayCooperCountryExpress: "https://www.claycoopertheatre.com/clay-coopers-country-express",
        presleysCountryJubilee: "https://www.presleys.com/",
        theHaygoods: "https://thehaygoods.com/",
        wonderWorks: "https://www.wonderworksonline.com/branson/",
        aquariumAtTheBoardwalk: "https://www.aquariumattheboardwalk.com/",
        titanicMuseum: "https://titanicattraction.com/branson",
        butterflyPalace: "https://thebutterflypalace.com/",
        ripleysBelieveItOrNot: "https://www.ripleys.com/attractions/ripleys-believe-it-or-not-branson",
        hollywoodWaxMuseum: "https://www.hollywoodwaxentertainment.com/branson-mo-attractions/hollywood-wax-museum/",
        jetSkiRentals: "https://www.stateparkmarina.com/boat-rentals",
        boatAndTubes: "https://www.stateparkmarina.com/boat-rentals"
    };

            const interestItems = [
                { id: 'andysCustard', name: "Andy‚Äôs Frozen Custard", category: "üç¶ Desserts & Treats (Interest Only)" },
                { id: 'cakesnCreams', name: "Cakes-n-Creams 50s Diner", category: "üç¶ Desserts & Treats (Interest Only)" },
                { id: 'kilwins', name: "Kilwins Chocolates & Ice Cream", category: "üç¶ Desserts & Treats (Interest Only)" },
                { id: 'parlorDoughnuts', name: "Parlor Doughnuts", category: "üç¶ Desserts & Treats (Interest Only)" },
                { id: 'sugarLeafBakery', name: "Sugar Leaf Bakery & Caf√©", category: "üç¶ Desserts & Treats (Interest Only)" },
                { id: 'melsHardLuckDiner', name: "Mel‚Äôs Hard Luck Diner", category: "üç¶ Desserts & Treats (Interest Only)" },
                
                { id: 'henningConservation', name: "Henning Conservation Area (Free Hiking)", category: "üèûÔ∏è Outdoors & Nature" },
                { id: 'lakesideForest', name: "Lakeside Forest Wilderness Area (Free Hiking)", category: "üèûÔ∏è Outdoors & Nature" },

                { id: 'tangerOutlets', name: "Outlet Mall Shopping Trip (Tanger Outlets)", category: "üõçÔ∏è Shopping & Free Time" },
                { id: 'bransonLanding', name: "Branson Landing (Free)", category: "üõçÔ∏è Shopping & Free Time" },
            ];

            const meals = [
                { id: 'Sunday_Breakfast', name: 'Sunday - Breakfast'}, { id: 'Sunday_Lunch', name: 'Sunday - Lunch'}, { id: 'Sunday_Dinner', name: 'Sunday - Dinner: BBQ Night'},
                { id: 'Monday_Breakfast', name: 'Monday - Breakfast'}, { id: 'Monday_Lunch', name: 'Monday - Lunch'}, { id: 'Monday_Dinner', name: 'Monday - Dinner: Taco Bar'},
                { id: 'Tuesday_Breakfast', name: 'Tuesday - Breakfast'}, { id: 'Tuesday_Lunch', name: 'Tuesday - Lunch'}, { id: 'Tuesday_Dinner', name: 'Tuesday - Dinner: Burgers & Brats'},
                { id: 'Wednesday_Breakfast', name: 'Wednesday - Breakfast'}, { id: 'Wednesday_Lunch', name: 'Wednesday - Lunch'}, { id: 'Wednesday_Dinner', name: 'Wednesday - Dinner: Pasta Night'},
                { id: 'Thursday_Breakfast', name: 'Thursday - Breakfast'}, { id: 'Thursday_Lunch', name: 'Thursday - Lunch'}, { id: 'Thursday_Dinner', name: 'Thursday - Dinner: Pizza Night'},
                { id: 'Friday_Breakfast', name: 'Friday - Breakfast'}, { id: 'Friday_Lunch', name: 'Friday - Lunch'}, { id: 'Friday_Dinner', name: 'Friday - Dinner: Leftovers / Free Night'},
                { id: 'Saturday_Breakfast', name: 'Saturday - Breakfast'}, { id: 'Saturday_Lunch', name: 'Saturday - Lunch'}, { id: 'Saturday_Dinner', name: 'Saturday - Dinner: Sandwich Bar'}
            ];

            // --- RENDER FUNCTIONS ---
            function renderContent() {
                const container = document.getElementById('excursions-container');
                container.innerHTML = '';
                
                const allItems = [...excursions, ...interestItems];
                const categories = [...new Set(allItems.map(item => item.category))];
                
                // Define the desired order of categories
                const categoryOrder = [
                    "üé¢ Adventure & Thrill",
                    "üèûÔ∏è Outdoors & Nature",
                    "‚õ≥ Golf & Recreation",
                    "üé≠ Shows & Entertainment",
                    "üß† Indoor Fun & Museums",
                    "üö§ Rentals (Shared Cost Estimate)",
                    "üç¶ Desserts & Treats (Interest Only)",
                    "üõçÔ∏è Shopping & Free Time"
                ];
                
                // Sort the found categories based on the desired order
                const sortedCategories = categories.sort((a, b) => {
                    const indexA = categoryOrder.indexOf(a);
                    const indexB = categoryOrder.indexOf(b);
                    if (indexA === -1) return 1; // Put categories not in the order list at the end
                    if (indexB === -1) return -1;
                    return indexA - indexB;
                });

                sortedCategories.forEach(category => {
                    const categoryWrapper = document.createElement('div');
                    
                    const categoryTitle = document.createElement('h3');
                    categoryTitle.className = 'text-xl font-bold text-gray-800 mb-4 border-b pb-2';
                    categoryTitle.textContent = category;
                    categoryWrapper.appendChild(categoryTitle);

                    // Handle priced excursions
                    const pricedItemsInCategory = excursions.filter(ex => ex.category === category);
                    if (pricedItemsInCategory.length > 0) {
                        const grid = document.createElement('div');
                        grid.className = 'grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6';
                        grid.innerHTML = pricedItemsInCategory.map(excursion => `
                            <div class="bg-gray-50 p-4 rounded-lg shadow-md flex flex-col justify-between transition-shadow hover:shadow-lg">
                                <div>
                                    <h4 class="text-lg font-bold">${EXCURSION_LINKS[excursion.id] ? `<a href="${EXCURSION_LINKS[excursion.id]}" target="_blank" rel="noopener" class="text-indigo-600 hover:underline">${excursion.name}</a>` : excursion.name}</h4>
                                    <p class="text-sm text-gray-600 mt-1">${excursion.description}</p>
                                    <div class="mt-3 text-sm font-semibold text-gray-700">
                                        Adults: $${excursion.adultPrice} | Children: $${excursion.childPrice}
                                    </div>
                                </div>
                                <div class="mt-4 space-y-3">
                                    <div class="flex items-center justify-between">
                                        <span class="font-medium">Adults</span>
                                        <div class="flex items-center space-x-2">
                                            <button type="button" data-id="${excursion.id}" data-type="adult" data-action="decrement" class="w-8 h-8 bg-gray-300 rounded-full flex items-center justify-center text-gray-700 hover:bg-gray-400">-</button>
                                            <span id="${excursion.id}-adult-count" class="font-bold text-lg w-6 text-center">${excursion.adultCount || 0}</span>
                                            <button type="button" data-id="${excursion.id}" data-type="adult" data-action="increment" class="w-8 h-8 bg-gray-300 rounded-full flex items-center justify-center text-gray-700 hover:bg-gray-400">+</button>
                                        </div>
                                    </div>
                                    <div class="flex items-center justify-between">
                                        <span class="font-medium">Children</span>
                                        <div class="flex items-center space-x-2">
                                            <button type="button" data-id="${excursion.id}" data-type="child" data-action="decrement" class="w-8 h-8 bg-gray-300 rounded-full flex items-center justify-center text-gray-700 hover:bg-gray-400">-</button>
                                            <span id="${excursion.id}-child-count" class="font-bold text-lg w-6 text-center">${excursion.childCount || 0}</span>
                                            <button type="button" data-id="${excursion.id}" data-type="child" data-action="increment" class="w-8 h-8 bg-gray-300 rounded-full flex items-center justify-center text-gray-700 hover:bg-gray-400">+</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        `).join('');
                        categoryWrapper.appendChild(grid);
                    }

                    // Handle interest-only items
                    const interestItemsInCategory = interestItems.filter(item => item.category === category);
                    if (interestItemsInCategory.length > 0) {
                        const list = document.createElement('div');
                        list.className = 'space-y-2 pt-2';
                        list.innerHTML = interestItemsInCategory.map(item => `
                            <div class="flex items-center">
                                <input type="checkbox" id="${item.id}" name="interest" value="${item.name}" class="h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500">
                                <label for="${item.id}" class="ml-2 block text-sm font-medium text-gray-700">${item.name}</label>
                            </div>
                        `).join('');
                        categoryWrapper.appendChild(list);
                    }
                    
                    container.appendChild(categoryWrapper);
                });
            }

            /* --------- NEW: Meals as day cards (purely visual, IDs/values unchanged) --------- */
            function renderMeals() {
                const mealsList = document.getElementById('meals-list');

                // Build a Day -> meals map (Breakfast, Lunch, Dinner: Menu)
                const dayOrder = ["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];
                const byDay = {};
                meals.forEach(m => {
                    const parts = m.name.split(' - ');
                    const day = parts[0] || '';
                    const rest = parts.slice(1).join(' - ') || '';

                    let type = rest;
                    let dinnerMenu = '';

                    if (rest.toLowerCase().startsWith('dinner')) {
                        type = 'Dinner';
                        const colon = rest.indexOf(':');
                        if (colon !== -1) dinnerMenu = rest.slice(colon + 1).trim();
                    }

                    if (!byDay[day]) byDay[day] = [];
                    byDay[day].push({
                        id: m.id,
                        name: m.name,
                        type,
                        dinnerMenu
                    });
                });

                const mealRow = (item) => {
                    const extra = (item.type === 'Dinner' && item.dinnerMenu)
                        ? ` ‚Äî <span class="text-gray-500">${item.dinnerMenu}</span>`
                        : '';
                    // IMPORTANT: preserve id/name/value exactly (logic + Google Form stay intact)
                    return `
                        <label for="${item.id}" class="flex items-center justify-between">
                            <div class="flex items-center">
                                <input type="checkbox" id="${item.id}" name="meal" value="${item.name}" class="h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500">
                                <span class="ml-2 text-sm font-medium text-gray-700">${item.type}${extra}</span>
                            </div>
                        </label>
                    `;
                };

                const cards = dayOrder
                    .filter(d => byDay[d])
                    .map(day => {
                        const items = byDay[day] || [];
                        const order = ['Breakfast','Lunch','Dinner'];
                        const ordered = order.map(t => items.find(i => i.type === t)).filter(Boolean);
                        return `
                            <div class="bg-gray-50 p-4 rounded-lg shadow-md hover:shadow-lg transition-shadow">
                                <h4 class="text-lg font-bold mb-3">${day}</h4>
                                <div class="space-y-2">
                                    ${ordered.map(mealRow).join('')}
                                </div>
                            </div>
                        `;
                    })
                    .join('');

                mealsList.innerHTML = `
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        ${cards}
                    </div>
                `;
            }
            /* ------------------------------------------------------------------------------- */

            // --- CALCULATION & UI UPDATE ---
            function updateSummary() {
                const lodgingCost = parseFloat(document.getElementById('lodgingCost').value) || 0;
                const extraBedCost = document.getElementById('extraBed').checked ? 450 : 0;
                const travelMode = document.getElementById('travelMode').value;
                const adultTravelers = parseInt(document.getElementById('adultTravelers').value) || 1;
                const childTravelers = parseInt(document.getElementById('childTravelers').value) || 0;
                
                let travelCost = 0;
                if (travelMode === 'flying') {
                    travelCost = (adultTravelers + childTravelers) * 400;
                } else if (travelMode === 'driving') {
                    const selectedOrigin = travelOriginSelect.options[travelOriginSelect.selectedIndex];
                    const distance = parseFloat(selectedOrigin.dataset.distance) || 0;
                    travelCost = (distance / 20) * 3.00 * 2; // Round trip calculation
                }
                
                let mealCost = 0;
                const adultMealCost = 8;
                const childMealCost = 4;
                document.querySelectorAll('#meals-list input[type="checkbox"]:checked').forEach(() => {
                    mealCost += (adultTravelers * adultMealCost) + (childTravelers * childMealCost);
                });

                let excursionCost = 0;
                excursions.forEach(excursion => {
                    excursionCost += ((excursion.adultCount || 0) * excursion.adultPrice) + ((excursion.childCount || 0) * excursion.childPrice);
                });

                const totalCost = lodgingCost + extraBedCost + travelCost + mealCost + excursionCost;

                document.getElementById('summary-lodging').textContent = `$${lodgingCost.toFixed(2)}`;
                document.getElementById('summary-extra-bed').textContent = `$${extraBedCost.toFixed(2)}`;
                document.getElementById('summary-travel').textContent = `$${travelCost.toFixed(2)}`;
                document.getElementById('summary-meals').textContent = `$${mealCost.toFixed(2)}`;
                document.getElementById('summary-excursions').textContent = `$${excursionCost.toFixed(2)}`;
                document.getElementById('summary-total').textContent = `$${totalCost.toFixed(2)}`;
                
                if (lodgingCost > 0 || totalCost > 0) {
                     costSummaryBar.style.display = 'block';
                }
            }
            
            function handleTravelModeChange() {
                mileageDetailsGroup.classList.toggle('hidden', document.getElementById('travelMode').value !== 'driving');
                updateSummary();
            }

            function showConfirmationPage() {
                mainContent.classList.add('hidden');
                confirmationPage.classList.remove('hidden');
                setTimeout(() => {
                    confirmationCard.classList.remove('scale-95', 'opacity-0');
                    confirmationCard.classList.add('scale-100', 'opacity-100');
                }, 100);

                let countdown = 5;
                const countdownElement = document.getElementById('countdown');
                const interval = setInterval(() => {
                    countdown--;
                    countdownElement.textContent = countdown;
                    if (countdown === 0) {
                        clearInterval(interval);
                        location.reload(); 
                    }
                }, 1000);
            }

            // --- EVENT LISTENERS ---
            reunionForm.addEventListener('change', updateSummary);
            document.getElementById('travelMode').addEventListener('change', handleTravelModeChange);

            reunionForm.addEventListener('click', (e) => {
                const target = e.target;
                if (target.matches('button[data-action]')) {
                    const id = target.dataset.id;
                    const type = target.dataset.type;
                    const action = target.dataset.action;
                    
                    const excursion = excursions.find(ex => ex.id === id);
                    if (excursion) {
                        const countKey = type === 'adult' ? 'adultCount' : 'childCount';
                        if (action === 'increment') {
                            excursion[countKey] = (excursion[countKey] || 0) + 1;
                        } else if (action === 'decrement' && (excursion[countKey] || 0) > 0) {
                            excursion[countKey]--;
                        }
                        document.getElementById(`${id}-${type}-count`).textContent = excursion[countKey];
                        updateSummary();
                    }
                }
            });

            reunionForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                
                const formData = new FormData();
                const formElements = reunionForm.elements;

                // Collect selected meals
                const selectedMeals = Array.from(document.querySelectorAll('input[name="meal"]:checked')).map(cb => cb.value);
                
                // Collect selected excursions
                const selectedExcursions = excursions
                    .filter(ex => (ex.adultCount || 0) > 0 || (ex.childCount || 0) > 0)
                    .map(ex => `${ex.name} (Adults: ${ex.adultCount || 0}, Children: ${ex.childCount || 0})`);
                
                // Collect interest-only items
                const interestItems = Array.from(document.querySelectorAll('input[name="interest"]:checked')).map(cb => cb.value);

                // Populate form data for submission
                formData.append(googleFormEntryIds.familyName, formElements.familyName.value);
                formData.append(googleFormEntryIds.attendees, formElements.attendees.value);
                const lodgingDetail = `${formElements.lodgingCost.options[formElements.lodgingCost.selectedIndex].text} (Extra Bed: ${formElements.extraBed.checked ? 'Yes' : 'No'})`;
                formData.append(googleFormEntryIds.lodging, lodgingDetail);
                const travelDetail = `Mode: ${formElements.travelMode.value}, Origin: ${formElements.travelOrigin.value}, Airport: ${formElements.arrivalAirport.value}`;
                formData.append(googleFormEntryIds.travelInfo, travelDetail);
                formData.append(googleFormEntryIds.travelers, `Adults: ${formElements.adultTravelers.value}, Children: ${formElements.childTravelers.value}`);
                formData.append(googleFormEntryIds.selectedMeals, selectedMeals.join(', ') || 'None');
                formData.append(googleFormEntryIds.selectedExcursions, selectedExcursions.join('; ') || 'None');
                formData.append(googleFormEntryIds.interestItems, interestItems.join(', ') || 'None');
                formData.append(googleFormEntryIds.totalCost, document.getElementById('summary-total').textContent);
                
                try {
                    await fetch(googleFormUrl, {
                        method: 'POST',
                        mode: 'no-cors',
                        body: formData
                    });
                    
                    showConfirmationPage();
                    reunionForm.reset();
                    renderContent(); // Re-render to reset counts to 0
                    updateSummary();

                } catch (error) {
                    console.error('Submission error:', error);
                    alert('There was an error submitting your form. Please check the console and ensure your Google Form URL is correct.');
                }
            });

            // --- INITIALIZATION ---
            renderMeals();
            renderContent();
            updateSummary();
            handleTravelModeChange();
        });
    </script>
</body>
</html>
